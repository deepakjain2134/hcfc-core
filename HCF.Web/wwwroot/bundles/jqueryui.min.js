function showthumImage(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(n){$("#user_img").attr("src",n.target.result)};t.readAsDataURL(n.files[0])}}function FillBuildings(){$("#BuildingID").html("");$("#BuildingID").append($("<option><\/option>").val("").html("Select Building"));var n=$("#PropertyId").val();n!=""&&$.ajax({url:"/Organization/FillBuildings",type:"GET",dataType:"JSON",data:{propertyId:n},success:function(n){$.each(n,function(n,t){$("#BuildingID").append($("<option><\/option>").val(t.BuildingId).html(t.BuildingName))})}})}function ShowLargeImage(n,t,i){swal({title:i+","+t,text:'<img src="'+$(n).attr("src")+'" alt="Image" height="400" width="100%" />',html:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Close",closeOnConfirm:!0})}function FillAssetsSubType(){$("#SubTypeId").html("");$("#SubTypeId").append($("<option><\/option>").val("").html("Select Sub Type"));var n=$("#TypeId").val();n!=""&&$.ajax({url:"/Assets/FillSubTypes",type:"GET",dataType:"JSON",data:{typeId:n},success:function(n){$.each(n,function(n,t){$("#SubTypeId").append($("<option><\/option>").val(t.SubTypeId).html(t.Name))})}})}function ShowEpDetails(){$(".epdeatils").empty();var n=$("#GoalId").val(),t=$("#EPDetailId").val();n!=""&&$.ajax({url:"/Goal/FillEPnumber",type:"GET",dataType:"JSON",data:{goalId:n},success:function(n){$.each(n,function(n,i){i.EPDetailId==t&&$(".epdeatils").append($("<div>").addClass("large-4 columns first").append($("<div>").addClass("name").html("<b> EP : <\/b>"+i.EPNumber)).append($("<div>").addClass("name").html("<b> Main Goal : <\/b>"+i.MainGoal)).append($("<div>").addClass("name").html("<b> Frequency : <\/b>"+i.FrequencyMaster.DisplayName)).append($("<div>").addClass("name").html("<b> Description : <\/b>"+i.Description)))})}})}function FillEPnumber(){$("#EPDetailId").html("");$(".epdeatils").empty();$("#EPDetailId").append($("<option><\/option>").val("").html("Select Sub Type"));var n=$("#GoalId").val();n!=""&&$.ajax({url:"/Goal/FillEPnumber",type:"GET",dataType:"JSON",data:{goalId:n},success:function(n){$.each(n,function(n,t){$("#EPDetailId").append($("<option><\/option>").val(t.EPDetailId).html(t.EPNumber))})}})}function BindEPs(n){$("#EpDetailId").html("");$("#EpDetailId").append($("<option><\/option>").val("").html("Select Eps"));n!=""&&$.ajax({url:"/Goal/EpByStandard",type:"GET",dataType:"JSON",data:{stdescId:n},success:function(n){$.each(n,function(n,t){$("#EpDetailId").append($("<option><\/option>").val(t.EPDetailId).html(t.EPNumber))})}})}function bindImage(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(n){$("#user_img").attr("src",n.target.result)};t.readAsDataURL(n.files[0])}}function ValidateNumber(n){var t=n||window.event,i=t.keyCode||t.which,r;i=String.fromCharCode(i);r=/[0-9]|\-/;r.test(i)||(t.preventDefault?t.preventDefault():t.returnValue=!1)}function getParameterByName(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function IsDateInBetween(n,t,i){return i>n&&i<t?!0:!1}function ConvertToDateTime(n,t){var i=Number(t.match(/^(\d+)/)[1]),f=Number(t.match(/:(\d+)/)[1]),e=t.match(/\s(.*)$/)[1],r,u;return e=="PM"&&i<12&&(i=i+12),e=="AM"&&i==12&&(i=i-12),r=i.toString(),u=f.toString(),i<10&&(r="0"+r),f<10&&(u="0"+u),new Date(n.getFullYear(),n.getMonth(),n.getDate(),r,u,0)}function setSeriesColor(n){var t="#800000";return n==="NonCompliant".toLowerCase()?t="#FF0000":n==="Compliant".toLowerCase()?t="#5cb85c":n==="Inprogress".toLowerCase()?t="#337ab7":n==="work orders".toLowerCase()?t="#337ab7":n==="deficiencies".toLowerCase()?t="#5cb85c":n==="risk assessment".toLowerCase()?t="#f0ad4e":n==="ilsm".toLowerCase()&&(t="#d9534f"),t}function getSeries(n){for(i=0;i<n.length;i++)n[i].color=setSeriesColor(n[i].name.toLowerCase());return n}function isValidEmail(n){return/^(([^<>()[\]\\.,;:\s@@\"]+(\.[^<>()[\]\\.,;:\s@@\"]+)*)|(\".+\"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}function inspectionStatus(n,t){triInsStatus(n,"-1","1","0",t)}function triInsStatus(n,t,i,r){switch(n.value){case t:n.value=i;break;case i:n.value=r;break;case r:n.value=t}SetInspectionValue(n)}function SetInspectionValue(n){var t=$(n).attr("tempName"),i;if($("input[name='"+t+"'][type=hidden]").val(n.value),$(n).val()==0?($("[tempname='"+t+"']").parent().parent().find("div.MarkDeficiency").removeClass("hide"),$("[tempname='"+t+"']").parent().parent().find("div.MarkDeficiency").addClass("show")):($("[tempname='"+t+"']").parent().parent().find("div.MarkDeficiency").removeClass("show"),$("[tempname='"+t+"']").parent().parent().find("div.MarkDeficiency").addClass("hide")),n.value=="0"){$("#selectAll").attr("checked",!1);var r=$(n).data("floorassetid"),u=$(n).data("epid");n.attributes["data-orgvalue"]!=undefined?$(n).val(parseInt(n.attributes["data-orgvalue"].value)):$(n).val(-1);$("#loadpartial").html("Loading...");i=CRxUrls.goal_assetssteps;$.get(i+"?epId="+u+"&inspectionId=0&floorAssetId="+r+"&isPopUp=true",function(n){$("#loadpartial").html(n);$("#loadpartial").fadeIn("fast");$('input:button[id^="InsStatus"]').each(function(){var n=$(this).val(1)})});$("#FailStepsPopup").modal("show")}}function getOrgName(n){return n.replace("&#39;","'").replace("&#x27;","'")}var singleDs=[];(function(n){function i(t){var i;return n(singleDs).each(function(){n(this)[0].id==t&&(i=n(this)[0])}),i}function t(t,i){this.form=t;this.isDirty=!1;this.options=i;this.history=["clean","clean"];this.id=n(t).attr("id");singleDs.push(this)}t.prototype={init:function(){this.saveInitialValues();this.setEvents()},saveInitialValues:function(){this.form.find("input, select, textarea").each(function(){n(this).attr("data-dirrty-initial-value",n(this).val())});this.form.find("input[type=checkbox], input[type=radio]").each(function(){n(this).is(":checked")?n(this).attr("data-dirrty-initial-value","checked"):n(this).attr("data-dirrty-initial-value","unchecked")})},setEvents:function(){var t=this;n(document).ready(function(){t.form.on("submit",function(){t.submitting=!0});if(t.options.preventLeaving)n(window).on("beforeunload",function(){if(t.isDirty&&!t.submitting)return t.options.leavingMessage});t.form.find("input, select").change(function(){t.checkValues()});t.form.find("input, textarea").on("keyup keydown blur",function(){t.checkValues()});t.form.find("input[type=radio], input[type=checkbox]").on("ifChecked",function(){t.checkValues()})})},checkValues:function(){var t=this,i;this.form.find("input, select, textarea").each(function(){var t=n(this).attr("data-dirrty-initial-value");n(this).val()!=t?n(this).attr("data-is-dirrty","true"):n(this).attr("data-is-dirrty","false")});this.form.find("input[type=checkbox], input[type=radio]").each(function(){var t=n(this).attr("data-dirrty-initial-value");n(this).is(":checked")&&t!="checked"||!n(this).is(":checked")&&t=="checked"?n(this).attr("data-is-dirrty","true"):n(this).attr("data-is-dirrty","false")});i=!1;this.form.find("input, select, textarea").each(function(){n(this).attr("data-is-dirrty")=="true"&&(i=!0)});i?t.setDirty():t.setClean();t.fireEvents()},fireEvents:function(){this.isDirty&&this.wasJustClean()&&this.form.trigger("dirty");!this.isDirty&&this.wasJustDirty()&&this.form.trigger("clean")},setDirty:function(){this.isDirty=!0;this.history[0]=this.history[1];this.history[1]="dirty"},setClean:function(){this.isDirty=!1;this.history[0]=this.history[1];this.history[1]="clean"},wasJustDirty:function(){return this.history[0]=="dirty"},wasJustClean:function(){return this.history[0]=="clean"}};n.fn.dirrty=function(r){var u;if(/^(isDirty)$/i.test(r)){u=i(n(this).attr("id"));u||(u=new t(n(this),r),u.init());switch(r){case"isDirty":return u.isDirty}}else if(typeof r=="object"||!r)return this.each(function(){r=n.extend({},n.fn.dirrty.defaults,r);var i=new t(n(this),r);i.init()})};n.fn.dirrty.defaults={preventLeaving:!0,leavingMessage:"You have unsaved changes",onDirty:function(){},onClean:function(){}}})(jQuery);String.prototype.format=String.prototype.f=function(){for(var n=this,t=arguments.length;t--;)n=n.replace(new RegExp("\\{"+t+"\\}","gm"),arguments[t]);return n};jQuery.extend(jQuery.fn.dataTableExt.oSort,{"non-empty-string-asc":function(n,t){return n==""?1:t==""?-1:n<t?-1:n>t?1:0},"non-empty-string-desc":function(n,t){return n==""?1:t==""?-1:n<t?1:n>t?-1:0}});var bindFloorddl=function(n,t,i,r,u){var f,e;t.html("<option> loading ... <\/option>");r==undefined&&(r="");u==undefined&&(u=$.Constants.Floor_ddl_text_Select_Floor);f=!1;t.html("");t.append($("<option><\/option>").val(r).html(u));e=n.val();e?$.ajax({url:CRxUrls.Organization_FillFloors,global:!1,type:"GET",dataType:"JSON",data:{buildingID:e},success:function(n){$.each(n,function(n,r){t.append($("<option><\/option>").val(r.FloorId).html(r.FloorName));r.FloorId===parseInt(i)&&(f=!0)});f?t.val(i):t.val("");var r=$("#StopId");r!==undefined&&r.trigger("change")}}):$("#FloorId").prop("required",!1)},bindStopddl=function(n,t,i,r,u){n.html("<option> loading ... <\/option>");n.html("");n.append($("<option><\/option>").val(r).html(u));t&&$.ajax({url:CRxUrls.Organization_FillStops,global:!1,type:"GET",dataType:"JSON",data:{floorId:t},success:function(t){$.each(t,function(t,i){n.append($("<option><\/option>").val(i.StopId).html(i.StopName+" ["+i.StopCode+"]"))});i>0?n.val(i):n.val("")}})},setDefaultStopDDL=function(n){n.append($("<option><\/option>").val("").html("Select Stop"))};BindStopNotInFE=function(n,t,i){var r=$("<option value />").text("Select Stop");n.append(r);$.ajax({type:"GET",url:CRxUrls.Organization_GetStopNotInFE,data:{AssetId:t,FloorId:i},datatype:"json",contentType:"application/json",success:function(t){t!=null?$.each(t,function(t,i){var r=$("<option />").attr("value",i.StopId).text(i.StopName+" ["+i.StopCode+"]");n.append(r)}):console.log(t)},error:function(n){console.log(n)}})};ResetAssetDropdown=function(n,t,i){n.find("option:eq(0)").prop("selected",!0);t.find("option:not(:first-child)").remove();i.find("option:not(:first-child)").remove()};removeCommaSeperatedValue=function(n,t,i){var r,u;for(i=i||",",r=n.split(i),u=0;u<r.length;u++)if(r[u]==t)return r.splice(u,1),r.join(i);return n},function(n){n.Constants={Policy:106,Report:107,MiscDocuments:108,SampleDocument:-1,AssetReport:109,CHILD_PAGE_ADMIN_CONFIRMATION:"These options have system-wide implications. Please contact your CRx Advisor before making changes.",Check_All_Status:"Please change status of all checkpoints.",Check_All_Status_Generator:"All items do not have values. Are you sure you have completed  everything that is applicable.",Create_Work_Order:"Do you want to create a work order ?",Alert_Msg_After_InsGrop_Completed:"This EP is not complete until EP checkpoints are reviewed and completed in next step.",Select_Atleast_One_Asset_To_Create_WO:"Select at least one asset to create a work order",PDF_Footer_Msg_Fire_Watch_Portal_module:"CRx by HCFCompliance: Fire Watch Portal Module",Delete_Manufacture_Msg:"Are you sure you wish to delete this manufacture?",This_Ep_Is_Already_Selected:"This EP is already selected!!",Select_standard_Ep:"Please select standard and EP to bind.",Email_Sent_Successfully:"Email sent successfully.",EMAIL_FAILED_MSG:"An error occurred while sending mail.",Remove_Assets_From_FloorPlan_Warning:"Are you want to remove this asset from floor!",Remove_Assets_From_FloorPlan_Success:"Your assets has been removed",RequestVerificationToken:"__RequestVerificationToken",Floor_ddl_text_All:"All",Floor_ddl_text_Select_Floor:"Select Floor",First_Close_Pending_ILSM:"Please close pending ILSM first before reinspecting",First_Close_Pending_Workorder:"Please close pending workorder first before reinspecting",Pin_Generated_Successfully:"Pin generated successfully",Browse_View_Files_In_IFrame:"https://view.officeapps.live.com/op/view.aspx?src=",ILSM_Information_Message:"Based on deficiencies, an ILSM incident #{0} was created.Please Document all Interim Life safety measures that are taken!",ILSM_Information_Existing_Message:"Based on deficiencies, this asset was added to existing ILSM incident #{0}.Please review to ensure all Interim Life safety measures that are taken and documented!",Delete_Digital_Signature:"Are you sure you wish to delete this signature?",Select_Atleast_One_Siemens_To_Create_WO:"Select at least one deficiency to create a work order",EP_Inspection_Ongoing_User:"<b>To Review this EP, the frequency must be changed from “Ongoing” by your CRx system administrator in <br /> Setup>More configurations>EP Configuration>EP Frequency <\/b>",EP_Inspection_Ongoing_Assets:"To Review this Asset, the frequency must be changed from “Ongoing” by your CRx system administrator in <br /> Setup>More configurations>EP Configuration>EP Frequency ",EP_Inspection_Attach_Assets:"Attach Assets First",All_Assets_Inspected:"Do you want to mark ep compliant ?",User_Deleted_Successfully:"User Deleted Successfully"};n.FloorAlias={AliasItem:[{Sequence:"25",AliasValue:"PE",AliasText:"Penthouse"},{Sequence:"24",AliasValue:"R",AliasText:"Roof"},{Sequence:"10",AliasValue:"10",AliasText:"10th Floor"},{Sequence:"9",AliasValue:"9",AliasText:"9th Floor"},{Sequence:"8",AliasValue:"8",AliasText:"8th Floor"},{Sequence:"7",AliasValue:"7",AliasText:"7th Floor"},{Sequence:"6",AliasValue:"6",AliasText:"6th Floor"},{Sequence:"5",AliasValue:"5",AliasText:"5th Floor"},{Sequence:"4",AliasValue:"4",AliasText:"4th Floor"},{Sequence:"3",AliasValue:"3",AliasText:"3rd Floor"},{Sequence:"2",AliasValue:"2",AliasText:"2nd Floor"},{Sequence:"1",AliasValue:"1",AliasText:"1st Floor"},{Sequence:"1",AliasValue:"GF",AliasText:"Ground Floor"},{Sequence:"0",AliasValue:"00",AliasText:"Level 00"},{Sequence:"-1",AliasValue:"LL",AliasText:"Lower Lobby"},{Sequence:"-2",AliasValue:"LL0",AliasText:"Lower Level"},{Sequence:"-2",AliasValue:"LL 1",AliasText:"Lower Level 1"},{Sequence:"-2",AliasValue:"LL 2",AliasText:"Lower Level 2"},{Sequence:"-2",AliasValue:"LL 3",AliasText:"Lower Level 3"},{Sequence:"-3",AliasValue:"B1",AliasText:"Basement"},{Sequence:"-5",AliasValue:"SB",AliasText:"Sub-Basement"},{Sequence:"-7",AliasValue:"B3",AliasText:"Sub-Sub-Basement"}]};n.CRx_DateFormat="M d, yy"}(jQuery),function(n){n.fn.shorten=function(t){"use strict";var i={showChars:100,minHideChars:10,ellipsesText:"...",moreText:"more",lessText:"less",onLess:function(){},onMore:function(){},errMsg:null,force:!1};if(t&&n.extend(i,t),n(this).data("jquery.shorten")&&!i.force)return!1;n(this).data("jquery.shorten",!0);n(document).off("click",".morelink");n(document).on({click:function(){var t=n(this);return t.hasClass("less")?(t.removeClass("less"),t.html(i.moreText),t.parent().prev().animate({position:"relative"},function(){t.parent().prev().prev().show()}).hide("fast",function(){i.onLess()})):(t.addClass("less"),t.html(i.lessText),t.parent().prev().animate({position:"relative"},function(){t.parent().prev().prev().hide()}).show("fast",function(){i.onMore()}).css({display:"inline"})),!1}},".morelink");return this.each(function(){var f=n(this),t=f.html(),y=f.text().length,e,r,l,c,v;if(y>i.showChars+i.minHideChars){if(e=t.substr(0,i.showChars),e.indexOf("<")>=0){var o=!1,h="",a=0,u=[],s=null;for(r=0,l=0;l<=i.showChars;r++)if(t[r]!="<"||o||(o=!0,s=t.substring(r+1,t.indexOf(">",r)),s[0]=="/"?s!="/"+u[0]?i.errMsg="ERROR en HTML: the top of the stack should be the tag that closes":u.shift():s.toLowerCase()!="br"&&u.unshift(s)),o&&t[r]==">"&&(o=!1),o)h+=t.charAt(r);else if(l++,a<=i.showChars)h+=t.charAt(r),a++;else if(u.length>0){for(c=0;c<u.length;c++)h+="<\/"+u[c]+">";break}e=n("<div/>").html(h+'<span class="ellip">'+i.ellipsesText+"<\/span>").html()}else e+=i.ellipsesText;v='<span class="shortcontent">'+e+'<\/span><span class="allcontent">'+t+'<\/span><span><a href="javascript://nop/" class="morelink">'+i.moreText+"<\/a><\/span>";f.html(v);f.find(".allcontent").hide();n(".shortcontent p:last",f).css("margin-bottom",0)}})}}(jQuery);